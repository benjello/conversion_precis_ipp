%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                                       MACROS                                          %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% Insertion d'une page vide sans numéro de page
\newcommand{\pagevide}{\newpage\pagestyle{empty}\mbox{}}

% Macro d'inclusion de graphiques %
\newcommand{\graphique}[2][1]{\begin{minipage}{\linewidth}\begin{center}\includegraphics[width=#1\linewidth,clip]{\cfcurrentfolder Figures/#2}\end{center}\end{minipage}}

% Macro d'inclusion de tableau %
\newcommand{\tableau}[1]{\input{\cfcurrentfolder Tableaux/#1}}

% Macro pour créer une figure (avec notes optionnelles) dans le corps du texte %
\newenvironment{fig}[4][1]{
\begin{figure}[!htb]
\centering
\begin{minipage}{14cm}
\caption{#2}
\end{minipage} \centering
\begin{minipage}{#1}
\centering#3
\end{minipage}
\if!#4!\empty \else
\begin{minipage}{#1}{\scriptsize\vspace{0.2cm}\setstretch{1.3}#4}
\end{minipage}\fi}
{\end{figure}}

% Macro pour créer une figure (avec notes) sur une page séparée %
\newenvironment{figp}[4][1]{
\begin{figure}[p]
\centering
\begin{minipage}{14cm}
\caption{#2}
\end{minipage}
\centering
\begin{minipage}{#1}
\centering#3
\end{minipage}
\if!#4!\empty \else \\
\begin{scriptsize}
\begin{minipage}{#1}\vspace{0.2cm}\setstretch{1.3} \par #4
\end{minipage}
\end{scriptsize} \fi }
{\end{figure}}

% Macro pour créer une subfigure au sein d'une figure
\newcommand{\subfig}[3][0.5]{\begin{subfigure}[b]{#1\linewidth}\centering\scalebox{1}{\graphique{#3}}\caption{#2}\end{subfigure}}

% Macro pour créer un tableau (avec notes optionnelles) %
\newenvironment{tab}[4][1]
{\def\TMP{#3}\newdimen\TMPsize\settowidth{\TMPsize}{\TMP}
\begin{table}[!htb]
\centering
\begin{minipage}{14cm}
\caption{#2}
\end{minipage}
\centering
\begin{minipage}{#1}
\resizebox{\textwidth}{!}{#3}
\end{minipage}
\if!#4!\empty \else \\
\begin{scriptsize}
\begin{minipage}{#1}\vspace{0.2cm}\setstretch{1.3} \par #4
\end{minipage}
\end{scriptsize} \fi }
{\end{table}}

% Macro pour créer un tableau (avec notes optionnelles) %
\newenvironment{tabp}[4][1]
{\def\TMP{#3}\newdimen\TMPsize\settowidth{\TMPsize}{\TMP}
\begin{table}[p]
\centering
\begin{minipage}{14cm}
%\caption{\setstretch{1.2}#2}
\caption{#2}
\end{minipage}
\centering
\begin{minipage}{#1}
\resizebox{\textwidth}{!}{#3}
\end{minipage}
\if!#4!\empty \else \\
\begin{scriptsize}
\begin{minipage}{#1}\vspace{0.2cm}\setstretch{1.3} \par #4
\end{minipage}
\end{scriptsize} \fi }
{\end{table}}

% Pour permettre de répartir du texte sur plusieurs lignes dans un tableau %
\newcommand{\minitab}[2][c]{\begin{tabular}{#1}#2\end{tabular}}

% Macro pour créer une longtable (avec notes optionnelles) %
\newlength{\tabwidth}
\setlength{\tabwidth}{14.2cm}
\newlength{\widthcola}
\newlength{\widthcolb}
\newenvironment{longtab}[3][0.25]{
\setlength{\widthcola}{\tabwidth*\real{#1}}
\setlength{\widthcolb}{\tabwidth-\tabwidth*\real{#1}}
\setstretch{1.2}
\begin{longtable}[c]{|>{\ttfamily}p{\widthcola}|p{\widthcolb}|}
\caption{#2}\\
#3}{\end{longtable} \setstretch{1.7}}


%%%%%%%%%%%%%%%%%%%
% Macro-variables %
%%%%%%%%%%%%%%%%%%%

% Pour écrire "2e", "3e" en exposant
\newcommand{\eme}{\textsuperscript{e}{}{}}
% Pour écrire "1er" en exposant
\newcommand{\er}{\textsuperscript{er}{}}
% Symbole indicatrice
\newcommand{\ind}{\mathds{1}}
% Raccourcis biblio
\newcommand{\cy}{\citeyear}
\newcommand{\cyp}{\citeyearpar}

% Création du logo TAXIPP
\makeatletter
\def\TAXIPP{TAX\kern-.05em\lower-.19ex\hbox{${\color{BlueGreen} \scalebox{1.4}{\underarc[1]{\overarc[1]{\textcolor{black}{\scalebox{0.7}{ipp}}}}}}\hspace{0.5ex}$}\@}
\makeatother

% Création du logo PENSIPP
\makeatletter
\def\PENSIPP{PENS\kern-.05em\lower-.19ex\hbox{${\color{BlueGreen} \scalebox{1.4}{\underarc[1]{\overarc[1]{\textcolor{black}{\scalebox{0.7}{ipp}}}}}}\hspace{0.5ex}$}\@}
\makeatother

\newcolumntype{L}[1]{>{\raggedright\let\newline\\\arraybackslash\hspace{0pt}}m{#1}}
\newcolumntype{C}[1]{>{\centering\let\newline\\\arraybackslash\hspace{0pt}}m{#1}}
\newcolumntype{R}[1]{>{\raggedleft\let\newline\\\arraybackslash\hspace{0pt}}m{#1}}
